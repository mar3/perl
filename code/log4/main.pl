#!/usr/bin/env perl
# coding: utf-8
#
#
#
#
# log4perl の例
#
#
#
#

use strict;
use utf8;
use Carp;
use Log::Log4perl;
use Time::HiRes;



###############################################################################
###############################################################################
###############################################################################
###############################################################################
###############################################################################
###############################################################################
package application;


sub get_logger {

	return Log::Log4perl->get_logger('myapp1');
}

sub subprocess {

	my $logger = application::get_logger();
	$logger->info('$$$ ○△□処理 開始 $$$');
	foreach (0..4) {
		$logger->debug('処理中...');
		Time::HiRes::sleep(rand(3));
	}
	$logger->info('--- ○△□処理 終了 ---');
}

sub run {

	Log::Log4perl::init('conf/log4perl.conf');
	my $logger = application::get_logger();

	$logger->info('### start ###');
	$logger->debug('デバッグメッセージ');
	$logger->info('情報');
	$logger->error('エラーメッセージ');

	application::subprocess();

	$logger->info('--- end ---');
}



###############################################################################
###############################################################################
###############################################################################
###############################################################################
###############################################################################
###############################################################################
package main;

sub _main {

	binmode(STDIN, ':utf8');
	binmode(STDOUT, ':utf8');
	binmode(STDERR, ':utf8');

	application::run();
}

_main(@ARGV);

